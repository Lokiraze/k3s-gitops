# ---
# apiVersion: helm.toolkit.fluxcd.io/v2beta1
# kind: HelmRelease
# metadata:
#   name: qbittorrent
#   namespace: media
# spec:
#   releaseName: qbittorrent
#   interval: 5m
#   chart:
#     spec:
#       # renovate: registryUrl=https://k8s-at-home.com/charts/
#       chart: qbittorrent
#       version: 11.2.0
#       sourceRef:
#         kind: HelmRepository
#         name: k8s-at-home
#         namespace: flux-system
#       interval: 5m
#   dependsOn:
#     - name: sealed-secrets
#       namespace: kube-system
#     - name: ingress-nginx-internal
#       namespace: networking
#   values:
#     image:
#       repository: ghcr.io/k8s-at-home/qbittorrent
#       tag: v4.3.4.1
#     ingress:
#       main:
#         enabled: true
#         ingressClassName: "internal"
#         annotations:
#           kubernetes.io/ingress.class: "internal"
#     podSecurityContext:
#       fsGroup: 1000
#       runAsGroup: 1000
#       runAsUser: 1000
#     timezone: "America/Phoenix"
#     env:
#       WAIT_FOR_VPN: "true"
#     persistence:
#       config:
#         enabled: true
#         size: 1Gi
#         storageClass: longhorn
#       downloads:
#         enabled: true
#         existingClaim: nfs-media-downloads-pvc
#       shared:
#         enabled: true
#         emptyDir:
#           enabled: true
#         mountPath: /shared
#     addons:
#       vpn:
#         enabled: true
#         type: openvpn
#         securityContext:
#           runAsGroup: 0
#           runAsUser: 0
#         env:
#           FIREWALL: 'on'
#         scripts:
#           up: |-
#             #!/bin/bash
#             /etc/openvpn/up.sh
#             echo "connected" > /shared/vpnstatus
#           down: |-
#             #!/bin/bash
#             /etc/openvpn/down.sh
#             echo "disconnected" > /shared/vpnstatus
#     resources:
#       requests:
#         memory: 250Mi
#         cpu: 10m
#       limits:
#         memory: 500Mi
#   valuesFrom:
#     - kind: Secret
#       name: qbittorrent-values
#       optional: false
